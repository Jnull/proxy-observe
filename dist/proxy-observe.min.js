!function(){function e(e,t,n){function r(){o.callback&&(o.changeset.length>0&&(o.callback(o.changeset),o.changeset=[]),setTimeout(r,0))}var o=this;o.target=e,o.callback=t,o.acceptlist=n,o.changeset=[],e.__observerCallbacks__||(Object.defineProperty(e,"__observerCallbacks__",{enumerable:!1,configurable:!0,writable:!1,value:[]}),Object.defineProperty(e,"__observers__",{enumerable:!1,configurable:!0,writable:!1,value:[]})),e.__observerCallbacks__.push(t),e.__observers__.push(this);var s=new Proxy(e,o);return o.proxy=s,r(),s}Object.observe||"object"!=typeof Proxy||(e.prototype.get=function(e,t){return"__observer__"===t?this:e[t]},e.prototype.set=function(e,t,n){var r=e[t],o=void 0===r?"add":"update";if(e[t]=n,!this.acceptlist||this.acceptlist.indexOf(o)>=0){var s={object:this.proxy,name:t,type:o};"update"===o&&(s.oldValue=r),this.changeset.push(s)}return!0},e.prototype.deleteProperty=function(e,t){var n=e[t];if(delete e[t],!this.acceptlist||this.acceptlist.indexOf("delete")>=0){var r={object:this.proxy,name:t,type:"delete",oldValue:n};this.changeset.push(r)}return!0},e.prototype.defineProperty=function(e,t,n){if(Object.defineProperty(e,t,n),!this.acceptlist||this.acceptlist.indexOf("reconfigure")>=0){var r={object:this.proxy,name:t,type:"reconfigure"};this.changeset.push(r)}return!0},e.prototype.setProtoypeOf=function(e,t){var n=Object.getPrototypeOf(e);if(Object.setPrototypeOf(e,t),!this.acceptlist||this.acceptlist.indexOf("setProtoype")>=0){var r={object:this.proxy,name:"__proto__",type:"setProtoype",oldValue:n};this.changeset.push(r)}return!0},e.prototype.preventExtensions=function(e){Object.getPrototypeOf(e);if(Object.preventExtensions(e),!this.acceptlist||this.acceptlist.indexOf("preventExtensions")>=0){var t={object:this.proxy,type:"preventExtensions"};this.changeset.push(t)}return!0},Object.observe=function(t,n,r){return new e(t,n,r)},Object.unobserve=function(e,t){e.__observerCallbacks__&&e.__observerCallbacks__.forEach(function(n,r){t===n&&(e.__observerCallbacks__.splice(r,1),delete e.__observers__[r].callback,e.__observers__.splice(r,1))})},Array.observe=function(e,t,n){var r=Object.observe(e,function(e){var n=[];e.forEach(function(e){"length"!==e.name&&"add"!==e.name&&n.push(e)}),n.length>0&&t(n)},n),o=e.splice;e.splice=function(e,t){var n=this.slice(e,t),s=arguments.length-1,c={object:r,type:"splice",index:e,removed:n,addedCount:s};o.apply(this,arguments),r.__observer__.changeset.push(c)};e.push;e.push=function(e){return this.splice(this.length-1,0,e)};e.pop;e.pop=function(){return this.splice(this.length-1,1)};e.unshift;e.unshift=function(e){return this.splice(0,0,e)};e.shift;return e.shift=function(){return this.splice(0,1)},r}),Object.deepObserve=function(e,t,n){n=n?n:[];var r=Object.keys(e);return e=Object.observe(e,function(e){function r(e,t,n,s,c){if(s instanceof Object){var i=Object.keys(s);i.forEach(function(i){if(!n||n[i]!==s[i]){var a=n&&void 0!==n[i]?n[i]:void 0,p=void 0===a?"add":"update",u=c+"."+i;o.push({name:e,object:t,type:p,oldValue:a,newValue:s[i],keypath:u}),r(e,t,a,s[i],u)}})}else if(n instanceof Object){var a=Object.keys(n);a.forEach(function(i){var a=null===s?"update":"delete",p=c+"."+i;o.push({name:e,object:t,type:a,oldValue:n[i],newValue:s,keypath:p}),r(e,t,n[i],void 0,p)})}}var o=[];e.forEach(function(e){var t=(n.length>0?n.join(".")+".":"")+e.name;o.push({name:e.name,object:e.object,type:e.type,oldValue:e.oldValue,newValue:e.object[e.name],keypath:t}),r(e.name,e.object,e.oldValue,e.object[e.name],t)}),t(o)}),r.forEach(function(r){if(e[r]instanceof Object){var o=n.slice(0);o.push(r),Object.deepObserve(e[r],t,o)}}),e}}();